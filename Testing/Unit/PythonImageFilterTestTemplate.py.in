#==========================================================================
#
#   Copyright NumFOCUS
#
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at
#
#          http://www.apache.org/licenses/LICENSE-2.0.txt
#
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.
#
#==========================================================================*/

#
# WARNING: DO NOT EDIT THIS FILE!
# THIS FILE IS AUTOMATICALLY GENERATED BY THE SIMPLEITK BUILD PROCESS.
# Please look at PythonImageFilterTestTemplate.py.in to make changes.
#

from __future__ import print_function

# This is Python code to test ${name}
import SimpleITK
import sys

inputs = 1
$(if number_of_inputs then
    OUT=[[inputs = ${number_of_inputs}]]
  end)

if len ( sys.argv ) < inputs + 2:
    print( "Usage: ${name} tag <input(s)> output" )
    sys.exit ( 1 )

tag = sys.argv[1]

reader = SimpleITK.ImageFileReader()
writer = SimpleITK.ImageFileWriter()
filter = SimpleITK.${name}()

$(if #tests == 0 then
    OUT=[[
print( "No tests defined!" )
sys.exit ( 1 )
    ]]
  end)

$(foreach tests
if tag == "${tag}":
$(when settings
$(foreach settings
$(if parameter == "SeedList" and python_value then
    OUT=[[    filter.ClearSeeds()
    $(for i=1,#python_value do OUT=OUT .. "\n    filter.AddSeed( " .. python_value[i] .. " )\n" end)]]
elseif parameter == "SeedList" then
    OUT=[[  filter.ClearSeeds()
    $(for i=1,#value do OUT=OUT .. "\n    filter.AddSeed( " .. value[i] .. " )\n" end)]]
elseif parameter == "TrialPoints" and python_value then
    OUT=[[    filter.ClearTrialPoints()
    $(for i=1,#python_value do OUT=OUT .. "\n    filter.AddTrialPoint( " .. python_value[i] .. " )\n" end)]]
elseif parameter == "TrialPoints" then
    OUT=[[  filter.ClearTrialPoints()
    $(for i=1,#value do OUT=OUT .. "\n    filter.AddTrialPoint( " .. value[i] .. " )" end)]]
elseif python_value then
OUT=[[
    filter.Set${parameter}( ${python_value} )]]
elseif dim_vec and dim_vec==1 then
OUT=[[
    filter.Set${parameter}( ( ]]
  for i=1,#value-1 do
    OUT=OUT..value[i]..", "
  end
  OUT=OUT..value[#value]..' ) )'
else
OUT=[[
    filter.Set${parameter}( ${value} )]]
end)
)
)

    inputs = []

    for i in range(2, len(sys.argv)-1 ):
      print( "reading ", sys.argv[i] )
      inputs.append( SimpleITK.ReadImage( sys.argv[i] ) );


$(if inputA_cast then
OUT=[[
    inputs[0] = SimpleITK.Cast( inputs[0], SimpleITK.${inputA_cast} );
     ]]
end)

$(if inputB_cast then
OUT=[[
    inputs[1] = SimpleITK.Cast( inputs[1], SimpleITK.${inputB_cast} );
     ]]
end)

    $(if not no_return_image then OUT=[[output = ]] end)filter.Execute( *tuple(inputs) )

    labelIDs = [SimpleITK.sitkLabelUInt8, SimpleITK.sitkLabelUInt16, SimpleITK.sitkLabelUInt32, SimpleITK.sitkLabelUInt64]
$(if not no_return_image then
OUT=[[
    if output.GetPixelIDValue() in labelIDs:
       output = SimpleITK.LabelMapToLabel(output)

    writer.UseCompressionOn()
    writer.SetFileName ( sys.argv[-1] )
    writer.Execute ( output )
]]
end)
)
